# CVE-2022-39952
POC for CVE-2022-39952 affecting Fortinet FortiNAC

The default configuration of this exploit writes a cron job to create a
reverse shell. Be sure to change the `payload` file to suite your environment.

## Technical Analysis
A technical root cause analysis of the vulnerability and indicators of compromise can be found on our blog:
https://www.horizon3.ai/fortinet-fortinac-cve-2022-39952-deep-dive-and-iocs

## Summary
This POC abuses the keyUpload.jsp endpoint to achieve an arbitrary file write.

## Usage
```plaintext
root@kali:~/CVE-2022-39952# python3 CVE-2022-39952.py -u 10.0.40.85 -pf payload
[+] Wrote payload to /etc/cron.d/payload
[+] Payload successfully delivered
```

## Troubleshooting
If using a cron based payload, make sure the payload file has the appropriate
permissions and owner:
```shell
sudo chown root:root payload
```
```shell
sudo chmod 0644 payload 
```

## Mitigations
Update to the latest version by following the instructions within the PSIRT
https://www.fortiguard.com/psirt/FG-IR-22-300

